alert tcp $ANY_ADDRESS any -> $TOMCAT_ADDR 8080 (
    msg:"CVE-2025-24813 - Writable PUT test via Content-Range";
    reference:cve,2025-24813;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/9;
    content:"PUT /check.txt";
    content:"Content-Range:";
    classtype: Tomcat-activity;
    sid:2481301;
    rev:1;
)

alert tcp $ANY_ADDRESS any -> $TOMCAT_ADDR 8080 (
    msg:"CVE-2025-24813 - Uploading serialized session payload via PUT";
    reference:cve,2025-24813;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/9;
    content:"PUT /hk1337.session";
    content:"Content-Range:";
    classtype: Tomcat-activity;
    sid:2481302;
    rev:1;
)

alert tcp $ANY_ADDRESS any -> $TOMCAT_ADDR 8080 (
    msg:"CVE-2025-24813 - Triggering deserialization via JSESSIONID";
    reference:cve,2025-24813;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/9;
    content:"GET /index.jsp";
    content:"Cookie: JSESSIONID=.hk1337";
    classtype: Tomcat-activity;
    sid:2481303;
    rev:1;
)

## This one is not perfectly precise i didnt succeed to match the 500 response

alert tcp $TOMCAT_ADDR 8080 -> $ANY_ADDRESS any 
(
    msg:"HTTP response seen from Tomcat";
    reference:cve,2025-24813;
    reference:url,https://github.com/TroutSoftware/eu-tis/issues/9;
    content:"HTTP/1.1";
    sid:2481304;
    classtype: Tomcat-activity;
    rev:1;
)
